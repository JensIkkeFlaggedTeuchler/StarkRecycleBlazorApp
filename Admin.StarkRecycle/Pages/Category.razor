@page "/Category"
@using ClassLibraryProducts.CustomModels;

<h3>Category</h3>

@*@if (categoryModel == null) {
    <p><em>Loading...</em></p>
}
else {
    <div class="card">
        <h4 class="card-header">Category</h4>

        <div class="card-body">
            <EditForm Model = "@categoryModel" OnValidSubmit="SaveCategory">
                <DataAnnotationsValidator />
                <div class="form-row">
                    <div class="form-group col-5">
                        <label>Name :</label>
                        <InputText @bind-Value="categoryModel.Name" class="form-control" />
                        <ValidationMessage For="@(() => categoryModel.Name)" />
                    </div>
                </div>
                <div class="text-left">
                    <input type="submit" class="btn btn-primary" value="Save" />
                    <input type="button" class="btn btn-primary" value="Clear" @onclick="ClearForm" />
                </div>
            </EditForm>
        </div>

        <div class="card-body bg-dark">
            @if (categoryList == null) {
                <p><em>Loading...</em></p>
            }
            else {
                <table class="table table-striped table-bordered bg-light">
                    <thead>
                        <tr>
                            <th style="width:15px;">Sr.No</th>
                            <th>category Name</th>
                            <th style="width:80px;">Edit?</th>
                            <th style="width:80px;">Delete?</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var (index, cat) in categoryList.Select((cat, i)=>(i + 1, cat))) {
                            <tr>
                                <td>@index</td>
                                <td>@cat.Name</td>
                                <td><input type="button" class="btn btn-primary" value="Edit" onclick="(() => EditButtonClick(cat))" /></td>
                                <td><input type="button" class="btn btn-primary" value="Edit" onclick="(() => DeleteButtonClick(cat))" /></td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>
}

@code {
    [CascadingParameter]
    public EventCallback notify { get; set; }

    public CategoryModel categoryModel { get; set; }

    private async Task SaveCategory() {
        await adminPanelService.Save();
    }

    protected override async Task OnAfterRenderAsync(bool firstReader) {
    .if (firstReader) {
            await notify.InvokeAsync();
        }
    }

}
*@